<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Orden de Trabajo - Fueltek</title>
  <link rel="stylesheet" href="styles.css" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
  <script src="https://cdn.sheetjs.com/xlsx-0.20.3/package/dist/xlsx.full.min.js"></script>
  <script src="https://unpkg.com/lucide@latest"></script>
</head>
<body>
  <div class="wrapper">
    <header>
      <img src="logo-fueltek.png" alt="Fueltek Logo" class="logo" />
      <div class="header-info">
        <h1>FUELTEK</h1>
        <p>Servicio Técnico Multimarca</p>
        <small>Tel: +56 9 4043 5805 | La Trilla 1062, San Bernardo</small>
      </div>
    </header>

    <main>
      <div class="ot-bar">
        <div class="left">
          <label class="ot-label">N° OT:</label>
          <input id="otNumber" readonly />
        </div>

        <button id="mobileMenuBtn" class="mobile-only" title="Menú"><i data-lucide="menu"></i></button>

        <div class="right" id="desktopMenu">
          <button id="newOrderBtn" class="primary"><i data-lucide="file-plus"></i> Nueva OT</button>
          <button id="saveOrderBtn" class="success"><i data-lucide="save"></i> Guardar OT</button>
          <button id="openModalBtn" class="secondary"><i data-lucide="folder-open"></i> Órdenes Guardadas</button>
          <button id="printBtn" class="accent"><i data-lucide="printer"></i> Imprimir</button>
          <button id="exportBtn"><i data-lucide="table"></i> Exportar a Excel</button>
        </div>
      </div>

      <section class="section-container">
        <h2>1. Información del Cliente/Vehículo</h2>
        <div class="row two-col">
          <div class="form-group">
            <label for="clientName">Nombre/Empresa Cliente:</label>
            <input id="clientName" type="text" />
          </div>
          <div class="form-group">
            <label for="clientRut">RUT/ID:</label>
            <input id="clientRut" type="text" />
          </div>
        </div>
        <div class="row two-col">
          <div class="form-group">
            <label for="clientPhone">Teléfono:</label>
            <input id="clientPhone" type="tel" />
          </div>
          <div class="form-group">
            <label for="clientEmail">Email:</label>
            <input id="clientEmail" type="email" />
          </div>
        </div>
        <div class="row three-col">
          <div class="form-group">
            <label for="vehicleBrand">Marca Vehículo:</label>
            <input id="vehicleBrand" type="text" />
          </div>
          <div class="form-group">
            <label for="vehicleModel">Modelo:</label>
            <input id="vehicleModel" type="text" />
          </div>
          <div class="form-group">
            <label for="vehiclePlate">Patente:</label>
            <input id="vehiclePlate" type="text" />
          </div>
        </div>
        <div class="row two-col">
          <div class="form-group">
            <label for="vehicleKm">Kilometraje:</label>
            <input id="vehicleKm" type="number" />
          </div>
          <div class="form-group">
            <label for="entryDate">Fecha de Ingreso:</label>
            <input id="entryDate" type="date" />
          </div>
        </div>
      </section>

      <section class="section-container">
        <h2>2. Trabajos Solicitados y Diagnóstico</h2>
        <div class="form-group">
          <label for="requestedWork">Descripción del Trabajo Solicitado por el Cliente:</label>
          <textarea id="requestedWork" rows="4" placeholder="Ej: Mantención de 10.000 km, revisión de frenos, problema de encendido..."></textarea>
        </div>
        <div class="form-group">
          <label for="diagnosis">Diagnóstico Inicial (por el técnico):</label>
          <textarea id="diagnosis" rows="4" placeholder="Ej: Se detecta desgaste en pastillas delanteras, falla en inyector #3, etc."></textarea>
        </div>
      </section>

      <section class="section-container">
        <h2>3. Repuestos y Materiales Utilizados</h2>
        <div class="parts-list-container">
          <div id="partsList" class="parts-list">
            </div>
          <button id="addPartBtn" class="small"><i data-lucide="plus-circle"></i> Agregar Repuesto/Material</button>
        </div>
      </section>

      <section class="section-container">
        <h2>4. Trabajo Realizado y Notas Adicionales</h2>
        <div class="form-group">
          <label for="workDone">Detalle del Trabajo Realizado:</label>
          <textarea id="workDone" rows="5" placeholder="Descripción detallada de las acciones tomadas, ajustes, pruebas, etc."></textarea>
        </div>
        <div class="form-group">
          <label for="finalNotes">Observaciones/Notas Finales:</label>
          <textarea id="finalNotes" rows="3" placeholder="Información importante para el cliente, recomendaciones, garantía."></textarea>
        </div>
      </section>

      <section class="section-container signatures-section">
        <h2>5. Costos y Aceptación</h2>
        <div class="row two-col">
          <div class="form-group">
            <label for="costLabor">Costo Mano de Obra (Neto):</label>
            <input id="costLabor" type="number" value="0" />
          </div>
          <div class="form-group">
            <label for="costParts">Costo Repuestos/Materiales (Neto):</label>
            <input id="costParts" type="number" value="0" readonly />
          </div>
        </div>
        <div class="total-cost-box">
          <h3>Costo Total Estimado (IVA Incluido):</h3>
          <span id="totalCost">$0</span>
        </div>
        
        <div class="signatures">
          <div class="signature-box">
            <p>Firma y Rut Cliente</p>
          </div>
          <div class="signature-box">
            <p>Firma y Rut Técnico</p>
          </div>
        </div>
        
        <section class="disclaimer">
          <h3>Condiciones de Servicio</h3>
          <ul>
            <li>El cliente declara recibir el vehículo a su plena satisfacción.</li>
            <li>La garantía cubre solo los trabajos y repuestos detallados en esta OT.</li>
            <li>No nos hacemos responsables por objetos de valor olvidados dentro del vehículo.</li>
          </ul>
        </section>
      </form>
    </main>

    <footer>
      <p>© 2025 FUELTEK</p>
    </footer>
  </div>

  <div id="modal" class="modal hidden" role="dialog" aria-hidden="true">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Órdenes guardadas</h3>
        <button id="closeModal" class="small">Cerrar</button>
      </div>
      <div class="modal-body">
        <input id="searchOt" placeholder="Buscar por N° OT o nombre cliente..." />
        <div id="ordersList" class="orders-list"></div>
      </div>
    </div>
  </div>

  <div id="printArea" class="print-area" style="display:none">
    <img id="printSeal" class="print-seal" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfQAAAH0CAYAAADL1t+KAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAE5WlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSfvu78nIGlkPSdXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQnPz4KPHg6eG1wbWV0YSB4bWxuczp4PSdhZG9iZTpuczptZXRhLyc+CjxyZGY6UkRGIHhtbG5zOnJkZj0naHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyc+CgogPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9JycKICB4bWxuczpBdHRyaWI9J2h0dHA6Ly9ucy5hdHRyaWJ1dGlvbi5jb20vYWRzLzEuMC8nPgogIDxBdHRyaWI6QWRzPgogICA8cmRmOlNlcT4KICAgIDxyZGY6bGkgcmRmOnBhcnNlVHlwZT0nUmVzb3VyY2UnPgogICAgIDxBdHRyaWI6Q3JlYXRlZD4yMDI1LTExLTExPC9BdHRyaWI6Q3JlYXRlZD4KICAgICA8QXR0
